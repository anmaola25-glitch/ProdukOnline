<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nasa Skincare — Admin</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body data-page="admin">
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="index.html"><h1>Nasa Skincare</h1></a>
      <nav class="nav">
        <button id="nav-toggle" class="nav-toggle" aria-label="Menu">☰</button>
        <ul class="nav-list" id="main-nav">
          <li><a href="index.html" class="nav-link">Beranda</a></li>
          <li><a href="kategori.html" class="nav-link">Kategori</a></li>
          <li><a href="bestseller.html" class="nav-link">BestSeler</a></li>
          <li><a href="promo.html" class="nav-link">Promo</a></li>
          <li><a href="kontak.html" class="nav-link">Kontak</a></li>
          <li><a href="checkout.html" class="nav-link">Checkout (<span id="cart-count">0</span>)</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <section id="admin-login-section">
      <h3>Admin Login (Demo)</h3>
      <form id="admin-login-form" class="admin-form">
        <label>Username<input type="text" name="username" required></label>
        <label>Password<input type="password" name="password" required></label>
        <div class="form-actions">
          <button class="btn primary" type="submit">Login</button>
        </div>
      </form>
      <p class="muted">Catatan: ini demo lokal. Password demo: <strong>admin123</strong></p>
    </section>

    <section id="admin-dashboard" class="hidden">
      <h3>Dashboard Admin</h3>
      <div class="admin-row">
        <div style="flex:1">
          <h4>Tambah Produk</h4>
          <form id="product-add-form" class="admin-form">
            <label>Nama<input name="name" required></label>
            <label>Kategori<input name="category" required></label>
            <label>Harga<input name="price" type="number" required></label>
            <label>Gambar (URL)<input name="image" required></label>
            <label>Short description<input name="short"></label>
            <label>Long description<textarea name="long"></textarea></label>
            <label><input type="checkbox" name="bestseller"> BestSeler</label>
            <label><input type="checkbox" name="promo"> Promo</label>
            <div class="form-actions"><button class="btn primary" type="submit">Tambah Produk</button></div>
          </form>
        </div>
        <div style="flex:1;margin-left:16px">
          <h4>Produk (dari localStorage)</h4>
          <div id="admin-products"></div>
        </div>
      </div>

      <div style="margin-top:16px">
        <button id="admin-logout" class="btn">Logout</button>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>&copy; <span id="year"></span> Nasa Skincare</p>
    </div>
  </footer>

  <script src="script.js" defer></script>
  <script>
    // Admin-specific behaviour kept here to simplify
    document.addEventListener('DOMContentLoaded', () => {
      const loginForm = document.getElementById('admin-login-form');
      const loginSection = document.getElementById('admin-login-section');
      const dashboard = document.getElementById('admin-dashboard');
      const logoutBtn = document.getElementById('admin-logout');
      const addForm = document.getElementById('product-add-form');
      const adminProducts = document.getElementById('admin-products');

      function renderAdminProducts(products) {
        adminProducts.innerHTML = '';
        if(!products || products.length === 0) {
          adminProducts.innerHTML = '<p>Tidak ada produk.</p>';
          return;
        }
        products.forEach(p => {
          const div = document.createElement('div');
          div.className = 'admin-prod';
          div.innerHTML = `
            <div style="display:flex;gap:10px;align-items:center">
              <img src="${p.image}" alt="${p.name}" style="width:70px;height:70px;object-fit:cover;border-radius:6px" />
              <div style="flex:1">
                <strong>${p.name}</strong><br/>
                <small class="muted">${p.category} • ${p.bestseller? 'BestSeler':''} ${p.promo? '• Promo':''}</small>
              </div>
              <div>
                <button class="btn" data-id="${p.id}" data-action="del">Hapus</button>
              </div>
            </div>
          `;
          adminProducts.appendChild(div);
        });
      }

      // check session
      if(sessionStorage.getItem('nasa_admin_logged') === '1') {
        loginSection.classList.add('hidden');
        dashboard.classList.remove('hidden');
        renderAdminProducts(window.NASA_PRODUCTS || []);
      }

      loginForm.addEventListener('submit', (ev) => {
        ev.preventDefault();
        const fd = new FormData(loginForm);
        const password = fd.get('password');
        // Demo credential
        if(password === 'admin123') {
          sessionStorage.setItem('nasa_admin_logged','1');
          loginSection.classList.add('hidden');
          dashboard.classList.remove('hidden');
          renderAdminProducts(window.NASA_PRODUCTS || []);
        } else {
          alert('Password salah (demo).');
        }
      });

      logoutBtn.addEventListener('click', () => {
        sessionStorage.removeItem('nasa_admin_logged');
        loginSection.classList.remove('hidden');
        dashboard.classList.add('hidden');
      });

      addForm.addEventListener('submit', (ev) => {
        ev.preventDefault();
        const fd = new FormData(addForm);
        const p = {
          id: 'p' + Date.now(),
          name: fd.get('name'),
          category: fd.get('category'),
          price: Number(fd.get('price')) || 0,
          image: fd.get('image'),
          short: fd.get('short') || '',
          long: fd.get('long') || '',
          bestseller: !!fd.get('bestseller'),
          promo: !!fd.get('promo')
        };
        // save to localStorage via global helper
        const list = JSON.parse(localStorage.getItem('nasa_products') || '[]');
        list.push(p);
        localStorage.setItem('nasa_products', JSON.stringify(list));
        window.NASA_PRODUCTS = list;
        renderAdminProducts(list);
        addForm.reset();
        alert('Produk ditambahkan (disimpan di browser).');
      });

      adminProducts.addEventListener('click', (e) => {
        const btn = e.target.closest('[data-action="del"]');
        if(!btn) return;
        const id = btn.getAttribute('data-id');
        if(!confirm('Hapus produk ini?')) return;
        let list = JSON.parse(localStorage.getItem('nasa_products') || '[]');
        list = list.filter(x => x.id !== id);
        localStorage.setItem('nasa_products', JSON.stringify(list));
        window.NASA_PRODUCTS = list;
        renderAdminProducts(list);
      });
    });
  </script>
</body>
</html>